global:
  resolve_timeout: 5m
route:
  group_by: ['alertname']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'discord-server-down'
  routes:
    - match:
        alert_type: server_down
      receiver: 'discord-server-down'
      repeat_interval: 30m
    - match:
        alert_type: server_up
      receiver: 'discord-server-up'
      repeat_interval: 1h
    - match:
        alert_type: server_inactive
      receiver: 'discord-server-inactive'
      repeat_interval: 15m
    - match:
        severity: critical
      receiver: 'discord-critical'
      repeat_interval: 30m
    - match:
        severity: warning
      receiver: 'discord-warning'
      repeat_interval: 1h
    - match:
        severity: info
      receiver: 'discord-info'
      repeat_interval: 2h
receivers:
  - name: 'discord-server-down'
    discord_configs:
      - webhook_url: 'https://discord.com/api/webhooks/1401898793477214259/tJtF0qpbWZh38taEXVfEu23qdbY53sb_Td3UROUItw-AFzoAeFZAEW5lRp-zTNiYBXLt'
        title: 'üö® SERVEUR TOMB√â - BenevoClic'
        message: |
          üö® **SERVEUR TOMB√â - BenevoClic**

          **‚ö†Ô∏è URGENCE: Le serveur est inaccessible !**

          **R√©sum√©:** {{ .CommonAnnotations.summary }}
          **Description:** {{ .CommonAnnotations.description }}
          **S√©v√©rit√©:** {{ .CommonLabels.severity }}
          **Service:** {{ .CommonLabels.service }}

          **D√©tails de l'incident:**
          {{ range .Alerts }}
          ‚Ä¢ **Instance:** {{ .Labels.instance }}
          ‚Ä¢ **Status:** {{ .Status }}
          ‚Ä¢ **Dur√©e:** {{ .StartsAt | since }}
          {{ end }}

          **Actions requises:**
          ‚Ä¢ üîç V√©rifier l'√©tat du serveur
          ‚Ä¢ üîÑ Red√©marrer les services si n√©cessaire
          ‚Ä¢ üìû Contacter l'√©quipe technique

          **Liens utiles:**
          ‚Ä¢ üìä [Prometheus](http://151.80.152.63:9090)
          ‚Ä¢ üìà [Grafana](http://151.80.152.63:3001)
          ‚Ä¢ üîç [API Health](http://151.80.152.63:3000/health)

          ---
          *üö® ALERTE CRITIQUE - Serveur Down*
        send_resolved: true

  - name: 'discord-server-up'
    discord_configs:
      - webhook_url: 'https://discord.com/api/webhooks/1401898793477214259/tJtF0qpbWZh38taEXVfEu23qdbY53sb_Td3UROUItw-AFzoAeFZAEW5lRp-zTNiYBXLt'
        title: '‚úÖ SERVEUR R√âTABLI - BenevoClic'
        message: |
          ‚úÖ **SERVEUR R√âTABLI - BenevoClic**

          **üéâ BONNE NOUVELLE: Le serveur est de nouveau op√©rationnel !**

          **R√©sum√©:** {{ .CommonAnnotations.summary }}
          **Description:** {{ .CommonAnnotations.description }}
          **S√©v√©rit√©:** {{ .CommonLabels.severity }}
          **Service:** {{ .CommonLabels.service }}

          **D√©tails de la r√©cup√©ration:**
          {{ range .Alerts }}
          ‚Ä¢ **Instance:** {{ .Labels.instance }}
          ‚Ä¢ **Status:** {{ .Status }}
          ‚Ä¢ **Dur√©e de l'incident:** {{ .StartsAt | since }} - {{ .EndsAt | since }}
          {{ end }}

          **Services r√©tablis:**
          ‚Ä¢ ‚úÖ API BenevoClic
          ‚Ä¢ ‚úÖ Monitoring Prometheus
          ‚Ä¢ ‚úÖ Alertes Discord
          ‚Ä¢ ‚úÖ Dashboards Grafana

          **Liens utiles:**
          ‚Ä¢ üìä [Prometheus](http://151.80.152.63:9090)
          ‚Ä¢ üìà [Grafana](http://151.80.152.63:3001)
          ‚Ä¢ üîç [API Health](http://151.80.152.63:3000/health)

          ---
          *‚úÖ R√âCUP√âRATION - Serveur Op√©rationnel*
        send_resolved: true

  - name: 'discord-server-inactive'
    discord_configs:
      - webhook_url: 'https://discord.com/api/webhooks/1401898793477214259/tJtF0qpbWZh38taEXVfEu23qdbY53sb_Td3UROUItw-AFzoAeFZAEW5lRp-zTNiYBXLt'
        title: '‚ö†Ô∏è SERVEUR INACTIF - BenevoClic'
        message: |
          ‚ö†Ô∏è **SERVEUR INACTIF - BenevoClic**

          **üìâ ATTENTION: Le serveur est inactif depuis trop longtemps !**

          **R√©sum√©:** {{ .CommonAnnotations.summary }}
          **Description:** {{ .CommonAnnotations.description }}
          **S√©v√©rit√©:** {{ .CommonLabels.severity }}
          **Service:** {{ .CommonLabels.service }}

          **D√©tails de l'inactivit√©:**
          {{ range .Alerts }}
          ‚Ä¢ **Instance:** {{ .Labels.instance }}
          ‚Ä¢ **Status:** {{ .Status }}
          ‚Ä¢ **Dur√©e d'inactivit√©:** {{ .StartsAt | since }}
          ‚Ä¢ **Derni√®re activit√©:** {{ .Annotations.last_activity | default "Inconnue" }}
          {{ end }}

          **Causes possibles:**
          ‚Ä¢ üîå Probl√®me de connectivit√© r√©seau
          ‚Ä¢ üíæ Surcharge du serveur
          ‚Ä¢ üîÑ Service en cours de red√©marrage
          ‚Ä¢ ‚ö° Probl√®me d'alimentation

          **Actions recommand√©es:**
          ‚Ä¢ üîç V√©rifier la connectivit√©
          ‚Ä¢ üìä Consulter les m√©triques syst√®me
          ‚Ä¢ üîÑ Red√©marrer si n√©cessaire

          **Liens utiles:**
          ‚Ä¢ üìä [Prometheus](http://151.80.152.63:9090)
          ‚Ä¢ üìà [Grafana](http://151.80.152.63:3001)
          ‚Ä¢ üîç [API Health](http://151.80.152.63:3000/health)

          ---
          *‚ö†Ô∏è ALERTE INACTIVIT√â - Surveillance Requise*
        send_resolved: true

  - name: 'discord-critical'
    discord_configs:
      - webhook_url: 'https://discord.com/api/webhooks/1401898793477214259/tJtF0qpbWZh38taEXVfEu23qdbY53sb_Td3UROUItw-AFzoAeFZAEW5lRp-zTNiYBXLt'
        title: 'üö® ALERTE CRITIQUE - BenevoClic'
        message: |
          üö® **Alerte BenevoClic**

          **R√©sum√©:** {{ .CommonAnnotations.summary }}
          **Description:** {{ .CommonAnnotations.description }}
          **S√©v√©rit√©:** {{ .CommonLabels.severity }}
          **Service:** {{ .CommonLabels.service }}

          **D√©tails:**
          {{ range .Alerts }}
          ‚Ä¢ **Instance:** {{ .Labels.instance }}
          ‚Ä¢ **Valeur:** {{ .Annotations.value }}
          ‚Ä¢ **Status:** {{ .Status }}
          {{ end }}

          **Liens utiles:**
          ‚Ä¢ üìä [Prometheus](http://151.80.152.63:9090)
          ‚Ä¢ üìà [Grafana](http://151.80.152.63:3001)
          ‚Ä¢ üîç [API Health](http://151.80.152.63:3000/health)

          ---
          *Alertmanager - BenevoClic Monitoring*
        send_resolved: true

  - name: 'discord-warning'
    discord_configs:
      - webhook_url: 'https://discord.com/api/webhooks/1401898793477214259/tJtF0qpbWZh38taEXVfEu23qdbY53sb_Td3UROUItw-AFzoAeFZAEW5lRp-zTNiYBXLt'
        title: '‚ö†Ô∏è ALERTE WARNING - BenevoClic'
        message: |
          üö® **Alerte BenevoClic**

          **R√©sum√©:** {{ .CommonAnnotations.summary }}
          **Description:** {{ .CommonAnnotations.description }}
          **S√©v√©rit√©:** {{ .CommonLabels.severity }}
          **Service:** {{ .CommonLabels.service }}

          **D√©tails:**
          {{ range .Alerts }}
          ‚Ä¢ **Instance:** {{ .Labels.instance }}
          ‚Ä¢ **Valeur:** {{ .Annotations.value }}
          ‚Ä¢ **Status:** {{ .Status }}
          {{ end }}

          **Liens utiles:**
          ‚Ä¢ üìä [Prometheus](http://151.80.152.63:9090)
          ‚Ä¢ üìà [Grafana](http://151.80.152.63:3001)
          ‚Ä¢ üîç [API Health](http://151.80.152.63:3000/health)

          ---
          *Alertmanager - BenevoClic Monitoring*
        send_resolved: true

  - name: 'discord-info'
    discord_configs:
      - webhook_url: 'https://discord.com/api/webhooks/1401898793477214259/tJtF0qpbWZh38taEXVfEu23qdbY53sb_Td3UROUItw-AFzoAeFZAEW5lRp-zTNiYBXLt'
        title: '‚ÑπÔ∏è INFO - BenevoClic'
        message: |
          üö® **Alerte BenevoClic**

          **R√©sum√©:** {{ .CommonAnnotations.summary }}
          **Description:** {{ .CommonAnnotations.description }}
          **S√©v√©rit√©:** {{ .CommonLabels.severity }}
          **Service:** {{ .CommonLabels.service }}

          **D√©tails:**
          {{ range .Alerts }}
          ‚Ä¢ **Instance:** {{ .Labels.instance }}
          ‚Ä¢ **Valeur:** {{ .Annotations.value }}
          ‚Ä¢ **Status:** {{ .Status }}
          {{ end }}

          **Liens utiles:**
          ‚Ä¢ üìä [Prometheus](http://151.80.152.63:9090)
          ‚Ä¢ üìà [Grafana](http://151.80.152.63:3001)
          ‚Ä¢ üîç [API Health](http://151.80.152.63:3000/health)

          ---
          *Alertmanager - BenevoClic Monitoring*
        send_resolved: true

inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname']
  - source_match:
      alert_type: 'server_down'
    target_match:
      alert_type: 'server_inactive'
    equal: ['service']